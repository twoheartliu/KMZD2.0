<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no"><meta name="format-detection" content="telephone=no" />
    <title>孔孟之道--我的作品</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css" />
    <style>
        html,
        body {
            background-color: #f2f2f2;
        }

        .fr {
            float: right;
        }

        .fl {
            float: left;
        }

        .p20px {
            padding: 0px 20px;
        }

        .row {
            display: -webkit-box;
            display: -webkit-flex;
        }

        .col {
            position: relative;
        }

        .wrapper {
            width: 100%;
            height: auto;
        }

        .egret-flex-item {
            /*display: -webkit-box;
          -webkit-box-align: center;*/
            height: 100px;
            background: #fff;
            width: 100%;
            overflow: hidden;
        }

        .egret-flex-items {
            /*display: -webkit-box;
            -webkit-box-align: center;*/
            height: 100px;
            width: 80%;
            float: left;
            padding: 0 10px;
        }

        .egret-flex-item-shelf {
            overflow: hidden;
            /*-webkit-box-flex: 2;
            -webkit-box-align: center;*/
        }

        .egret-flex-item-shelf .egret-flex-item-shelf001 {
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
            margin-top: 5px;
            height: 50px;
            line-height: 50px;
        }

        .egret-flex-item-shelf div {
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
            /*margin-top: 5px;*/
            height: 30px;
            line-height: 30px;
        }

        .egret-flex-item-shelf .egret-flex-item-shelf01 .span1 {
            /*font-size: 13px;*/
            font-size: 15px;
            color: #000;
        }

        .egret-flex-item-shelf .egret-flex-item-shelf02 .span2 {
            font-size: 12px;
            color: #ff3db8;
            margin: 0 5px;
        }

        .egret-flex-item-shelf .egret-flex-item-shelf01 .span3 {
            font-size: 12px;
            color: #ccc;
        }

        .egret-flex-item-shelf04 {
            width: 10%;
            text-align: right;
            /*-webkit-box-flex: 1;
          -webkit-box-align: center;*/
            /*display: inline-block;*/
            float: left;
            height: 100px;
            padding-right: 10px;
            padding-top: 5px;
        }

        .egret-flex-item-shelf004 {
            width: 10%;
            text-align: right;
            /*-webkit-box-flex: 1;
          -webkit-box-align: center;*/
            /*display: inline-block;*/
            float: left;
            height: 85px;
            padding-right: 10px;
            padding-top: 16px;
        }

        .egret-flex-item-shelf004 img {
            width: 20px;
            height: 20px;
        }

        .egret-flex-item-shelf04 img {
            width: 20px;
            height: 20px;
        }

        .egret-flex-item-shelf .egret-flex-item-shelf02 {
            font-size: 12px;
            color: #666;
        }

        .egret-flex-item-shelf .egret-flex-item-shelf02 span {
            font-size: 13px;
            color: #ccc;
        }

        .egret-flex-item-shelf03 {
            line-height: 20px;
        }

        .egret-flex-item-shelf03 div {
            float: left;
            /*line-height: 20px;
            margin: 5px 0px;*/
        }

        .egret-flex-item-shelf03 div img {
            width: 12px;
            height: 12px;
            line-height: 12px;
            /*margin: 0 2px;*/
            margin: 0px 2px -2px;
        }

        .egret-flex-item-shelf03 div span {
            line-height: 22px;
            vertical-align: middle;
            font-size: 11px;
            color: #b2b2b2;
        }

        .noHistory {
            color: #999;
            font-size: 15px;
            margin-top: 20px;
            width: 100%;
            text-align: center;
        }

        .hdivider {
            margin-bottom: 10px;
        }

        #footer {
            width: 100%;
            height: 50px;
            line-height: 50px;
            text-align: center;
        }
        /*加载loading的样式css 到结束*/

        #loadEffect {
            position: fixed;
            top: 33.33%;
            left: calc((50%) - 25px);
        }

        .loadEffect {
            width: 50px;
            height: 50px;
            position: absolute;
            margin: 0 auto;
            /*margin-top:100px;*/
            /*position: fixed;*/
        }

        .loadEffect span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ccc;
            position: absolute;
            -webkit-animation: load 1.04s ease infinite;
        }

        @-webkit-keyframes load {
            0% {
                opacity: 1;
            }
            100% {
                opacity: 0.2;
            }
        }

        .loadEffect span:nth-child(1) {
            left: 0;
            top: 50%;
            margin-top: -4px;
            -webkit-animation-delay: 0.13s;
        }

        .loadEffect span:nth-child(2) {
            left: 7px;
            top: 7px;
            -webkit-animation-delay: 0.26s;
        }

        .loadEffect span:nth-child(3) {
            left: 50%;
            top: 0;
            margin-left: -4px;
            -webkit-animation-delay: 0.39s;
        }

        .loadEffect span:nth-child(4) {
            top: 7px;
            right: 7px;
            -webkit-animation-delay: 0.52s;
        }

        .loadEffect span:nth-child(5) {
            right: 0;
            top: 50%;
            margin-top: -4px;
            -webkit-animation-delay: 0.65s;
        }

        .loadEffect span:nth-child(6) {
            right: 7px;
            bottom: 7px;
            -webkit-animation-delay: 0.78s;
        }

        .loadEffect span:nth-child(7) {
            bottom: 0;
            left: 50%;
            margin-left: -4px;
            -webkit-animation-delay: 0.91s;
        }

        .loadEffect span:nth-child(8) {
            bottom: 7px;
            left: 7px;
            -webkit-animation-delay: 1.04s;
        }
    </style>
</head>

<body>
    <div class="wrapper" id="wrap">
        <!-- <div class="noHistory"></div>   -->
        <!-- <div class="egret-flex-item" >
          <div class="egret-flex-items" tapmode="fmbtnhover" onclick="openFM()">
            <div class="egret-flex-item-shelf">
                <div class="egret-flex-item-shelf001">
                    <span class="span1 fl">作品：<span>《沁园春·雪》</span></span>
                </div>
                <div class="egret-flex-item-shelf02"><span>唐嫣</span>
                </div>
                <div class="egret-flex-item-shelf03">
                    <div><img src="../image/KM_play.png" alt=""><span>100</span></div>
                    <div><img src="../image/KM_zf.png" alt=""><span>100</span></div>
                    <div><img src="../image/KM_dz.png" alt=""><span>100</span></div>
                </div>
            </div>
          </div>
          <div class="egret-flex-item-shelf004" onclick="fnOpenPlayMore()">
            <img src="../image/KM_list_more.png" alt="">
          </div>
        </div>
        <div class="hdivider"></div>
        <div class="egret-flex-item" >
          <div class="egret-flex-items" tapmode="fmbtnhover" onclick="openFM()">
            <div class="egret-flex-item-shelf">
                <div class="egret-flex-item-shelf01">
                    <span class="span1 fl">作品：<span>《沁园春·雪》</span></span>
                </div>
                <div class="egret-flex-item-shelf02"><span>唐嫣</span>
                </div>
                <div class="egret-flex-item-shelf03">
                    <div><img src="../image/KM_play.png" alt=""><span>100</span></div>
                    <div><img src="../image/KM_zf.png" alt=""><span>100</span></div>
                    <div><img src="../image/KM_dz.png" alt=""><span>100</span></div>
                </div>
            </div>
          </div>
          <div class="egret-flex-item-shelf04" onclick="fnOpenPlayMore()">
            <img src="../image/KM_list_more.png" alt="">
          </div>
        </div>
        <div class="hdivider"></div> -->
    </div>
    <div id="footer" class="disnone">
        正在加载更多
    </div>
    <!-- 加载loading的dom -->
    <div id="loadEffect"></div>
    <!-- ~~~~ -->
</body>

</html>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/common.js"></script>
<script type="text/javascript" src="../script/wxfx.js"></script>
<script type="text/javascript">
    var token;
    var p = 1;
    var isFirst = true;
    apiready = function() {
            // 刚开始的时候加载loading
            var loadEffect = $api.byId('loadEffect');
            htmlloadEffect = '<div class="loadEffect"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div>'
            $api.html(loadEffect, htmlloadEffect);

            token = $api.getStorage('token');
            fnProductList();
            api.setCustomRefreshHeaderInfo({
                bgColor: '#f0f0f0',
                image: {
                    pull: [
                        'widget://image/Refresh/dropdown_anim_00.png',
                        'widget://image/Refresh/dropdown_anim_01.png',
                        'widget://image/Refresh/dropdown_anim_02.png',
                        'widget://image/Refresh/dropdown_anim_03.png',
                        'widget://image/Refresh/dropdown_anim_04.png',
                        'widget://image/Refresh/dropdown_anim_05.png',
                        'widget://image/Refresh/dropdown_anim_06.png',
                        'widget://image/Refresh/dropdown_anim_07.png',
                        'widget://image/Refresh/dropdown_anim_08.png',
                        'widget://image/Refresh/dropdown_anim_09.png',
                        'widget://image/Refresh/dropdown_anim_10.png',
                    ],
                    load: [
                        'widget://image/Refresh/dropdown_anim_00.png',
                        'widget://image/Refresh/dropdown_anim_01.png',
                        'widget://image/Refresh/dropdown_anim_02.png',
                        'widget://image/Refresh/dropdown_anim_03.png',
                        'widget://image/Refresh/dropdown_anim_04.png',
                        'widget://image/Refresh/dropdown_anim_05.png',
                    ]
                }
            }, function() {
                //下拉刷新被触发，自动进入加载状态，使用 api.refreshHeaderLoadDone() 手动结束加载中状态
                //下拉刷新被触发，使用 api.refreshHeaderLoadDone() 结束加载中状态
                var p = 1;
                setTimeout(function(){
                  fnProductList();
                },500);

            });
            api.addEventListener({
                name: 'scrolltobottom',
                extra: {
                    threshold: -20 //设置距离底部多少距离时触发，默认值为0，数字类型
                }
            }, function(ret, err) {
                var footer = $api.byId('footer');
                $api.html(footer, '没有更多结果了');
                p++;
                fnProductLists();
            });
        }
        //调接口
    function fnProductList() {
        api.ajax({
            url: host + apiUri + '/user/records',
            method: 'get',
            dataType: 'json',
            headers: {
                "source": api.systemType,
                "version": version,
                "session": token
            },
            data: {
                values: {
                    p: p
                }
            }
        }, function(ret, err) {
            if (ret.status == 200) {
                // 这个是关闭loading再掉通第一个接口的地方加
                var loadEffect = $api.byId('loadEffect');
                htmlloadEffect = '';
                $api.html(loadEffect, htmlloadEffect);
                // ~~~~~~~~~~~~~~
                api.refreshHeaderLoadDone()
                if (ret.data) {
                    // setTimeout(function(){
                    // },3000)
                    var data = ret.data;
                    var len = ret.data.length;
                    var stylelists = $api.byId('wrap');
                    // console.log(222);
                    var htmls = '';
                    for (var i = 0; i < ret.data.length; i++) {
                        if (ret.data[i].author_name = "null") {
                            htmls += '<div class="egret-flex-item" id="' + ret.data[i].id +
                                '"><div class="egret-flex-items" tapmode="fmbtnhover" onclick="openFM(' + ret.data[i].id + ')"><div class="egret-flex-item-shelf"><div class="egret-flex-item-shelf001"><span class="span1 fl"><span>' + ret.data[
                                    i].title +
                                '</span></span></div><div class="egret-flex-item-shelf03"><div><img src="../image/KM_play.png" alt=""><span>' + ret.data[i].play_total +
                                '</span></div><div><img src="../image/KM_zf.png" alt=""><span>' + ret.data[i].share_total + '</span></div>  <div><img src="../image/KM_dz.png" alt=""><span>' + ret.data[i].good_total +
                                '</span></div></div></div></div><div class="egret-flex-item-shelf004" onclick="fnOpenPlayMore(' + ret.data[i].id + ',\'' + ret.data[i].title + '\',\'' + ret.data[i].sma +
                                '\')"><img src="../image/KM_list_more.png" alt=""></div></div><div class="hdivider"></div>';

                        } else {
                            htmls += '<div class="egret-flex-item" id="' + ret.data[i].id +
                                '"><div class="egret-flex-items" tapmode="fmbtnhover" onclick="openFM(' + ret.data[i].id + ')"><div class="egret-flex-item-shelf"><div class="egret-flex-item-shelf01"><span class="span1 fl"><span>' + ret.data[
                                    i].title +
                                '</span></span></div><div class="egret-flex-item-shelf02"><span>' + ret.data[i].author_name + '</span></div><div class="egret-flex-item-shelf03"><div><img src="../image/KM_play.png" alt=""><span>' + ret.data[i]
                                .play_total +
                                '</span></div><div><img src="../image/KM_zf.png" alt=""><span>' + ret.data[i].share_total + '</span></div>  <div><img src="../image/KM_dz.png" alt=""><span>' + ret.data[i].good_total +
                                '</span></div></div></div></div><div class="egret-flex-item-shelf04" onclick="fnOpenPlayMore(' + ret.data[i].id + ',\'' + ret.data[i].title + '\',\'' + ret.data[i].sma +
                                '\')"><img src="../image/KM_list_more.png" alt=""></div></div><div class="hdivider"></div>';
                        }

                    }
                    if (p == 1) {
                        if (ret.data.length < 8) {
                            var footer = $api.byId('footer');
                            // $api.css(footer, 'display:none');
                            $api.remove(footer);
                        }
                    } else {
                        if (ret.data == '') {
                            var footer = $api.byId('footer');
                            var t =
                                `
                                没有更多结果了
                                `
                            $api.html(footer, '没有更多结果了');
                            // isFirst = false;
                        } else {
                            var footer = $api.byId('footer');
                            $api.html(footer, '上拉加载更多');

                        }
                    }
                    $api.html(stylelists, htmls);
                    api.sendEvent({
                        name: 'netNum',
                        extra: {
                            productNum: len
                        }
                    });



                } else {
                    // console.log(1111);
                    var footer = $api.byId('footer');
                    $api.html(footer, '');
                    var stylelist = $api.byId('wrap');
                    var html = '<div class="noHistory">您还没有上传作品，赶快去朗诵自己的作品吧~</div>';
                    $api.html(stylelist, html);
                }

            } else {
                // alert(JSON.stringify(err));
            }

        });
    }

    function fnProductLists() {
        api.ajax({
            url: host + apiUri + '/user/records',
            method: 'get',
            dataType: 'json',
            headers: {
                "source": api.systemType,
                "version": version,
                "session": token
            },
            data: {
                values: {
                    p: p
                }
            }
        }, function(ret, err) {
            if (ret.status == 200) {
                api.refreshHeaderLoadDone()
                if (ret.data) {
                    // setTimeout(function(){
                    // },3000)
                    var data = ret.data;
                    var len = ret.data.length;
                    var stylelist = $api.byId('wrap');
                    var html = '';
                    if (data == ' ') {
                        html = '<div class="noHistory">您还没有上传作品，赶快去朗诵自己的作品吧~</div>';
                        // alert(111);
                        $api.html(stylelist, html);
                    } else {
                        var stylelists = $api.byId('wrap');
                        // var htmls = '';
                        for (var i = 0; i < ret.data.length; i++) {
                            if (ret.data[i].author_name = "null") {
                                $api.append(stylelists, '<div class="egret-flex-item" id="' + ret.data[i].id +
                                    '"><div class="egret-flex-items" tapmode="fmbtnhover" onclick="openFM(' + ret.data[i].id + ')"><div class="egret-flex-item-shelf"><div class="egret-flex-item-shelf001"><span class="span1 fl"><span>' +
                                    ret.data[i].title +
                                    '</span></span></div><div class="egret-flex-item-shelf03"><div><img src="../image/KM_play.png" alt=""><span>' + ret.data[i].play_total +
                                    '</span></div><div><img src="../image/KM_zf.png" alt=""><span>' + ret.data[i].share_total + '</span></div>  <div><img src="../image/KM_dz.png" alt=""><span>' + ret.data[i].good_total +
                                    '</span></div></div></div></div><div class="egret-flex-item-shelf004" onclick="fnOpenPlayMore(' + ret.data[i].id + ',\'' + ret.data[i].title + '\',\'' + ret.data[i].sma +
                                    '\')"><img src="../image/KM_list_more.png" alt=""></div></div><div class="hdivider"></div>');

                            } else {
                                $api.append(stylelists, '<div class="egret-flex-item" id="' + ret.data[i].id +
                                    '"><div class="egret-flex-items" tapmode="fmbtnhover" onclick="openFM(' + ret.data[i].id + ')"><div class="egret-flex-item-shelf"><div class="egret-flex-item-shelf01"><span class="span1 fl"><span>' +
                                    ret.data[i].title +
                                    '</span></span></div><div class="egret-flex-item-shelf02"><span>' + ret.data[i].author_name + '</span></div><div class="egret-flex-item-shelf03"><div><img src="../image/KM_play.png" alt=""><span>' +
                                    ret.data[i].play_total +
                                    '</span></div><div><img src="../image/KM_zf.png" alt=""><span>' + ret.data[i].share_total + '</span></div>  <div><img src="../image/KM_dz.png" alt=""><span>' + ret.data[i].good_total +
                                    '</span></div></div></div></div><div class="egret-flex-item-shelf04" onclick="fnOpenPlayMore(' + ret.data[i].id + ',\'' + ret.data[i].title + '\',\'' + ret.data[i].sma +
                                    '\')"><img src="../image/KM_list_more.png" alt=""></div></div><div class="hdivider"></div>');
                            }

                        }
                        // $api.html(stylelists, htmls);
                        api.sendEvent({
                            name: 'netNum',
                            extra: {
                                productNum: len
                            }
                        });
                    }


                } else {
                    // console.log(1111);
                    var footer = $api.byId('footer');
                    $api.html(footer, '没有更多结果了');
                }

            } else {
                // alert(JSON.stringify(err));
            }

        });
    }

    //打开更多页面
    function fnOpenPlayMore(id, titleName, sma) {
        var dialogBox = api.require('dialogBox');
        dialogBox.actionMenu({
            rect: {
                h: 150
            },
            texts: {
                cancel: '取消'
            },
            items: [{
                text: '添加到听单',
                icon: 'widget://image/KM_play_add_gray.png'
            }, {
                text: '分享',
                icon: 'widget://image/KM_ListingsListGd.png'
            }, {
                text: '删除',
                icon: 'widget://image/shanchus.png'
            }],
            styles: {
                bg: '#FFF',
                column: 3,
                itemText: {
                    color: '#000',
                    size: 12,
                    marginT: 8
                },
                itemIcon: {
                    size: 30
                },
                cancel: {
                    bg: 'fs://icon.png',
                    color: '#000',
                    h: 44,
                    size: 14
                }
            },
            tapClose: true
        }, function(ret) {
            if (ret.eventType == 'cancel') {
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
            }
            if (ret.index == "0") {
                fnOpenAddListening(id);
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
            } else if (ret.index == "1") {
                if (sma == undefined) {
                    dialogBox.close({
                        dialogName: 'actionMenu'
                    });
                    var sma = '/logo_144x144.png'
                    fnOpenPlayShare(id, titleName, sma);
                } else {
                    dialogBox.close({
                        dialogName: 'actionMenu'
                    });
                    fnOpenPlayShare(id, titleName, sma);
                }

                // api.openWin({
                //   name: 'playDiscuss',
                //   url: './play_discuss.html',
                // })
            } else if (ret.index == "2") {
                // alert("删除");

                dialogBox.close({
                    dialogName: 'actionMenu'
                });
                fnalert(id);
            } else {
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
            }
        });
    }

    //打开分享
    function fnOpenPlayShare(id, titleName, sma) {
        // console.log(id);
        // console.log(sma);
        var dialogBox = api.require('dialogBox');
        dialogBox.actionMenu({
            rect: {
                h: 150
            },
            texts: {
                cancel: '取消'
            },
            items: [{
                text: '微信',
                icon: 'widget://image/weixin.png'
            }, {
                text: '朋友圈',
                icon: 'widget://image/friends.png'
            }, {
                text: 'QQ',
                icon: 'widget://image/qq.png'
            }, {
                text: 'QQ空间',
                icon: 'widget://image/QQkongjian.png'
            }],
            styles: {
                bg: '#FFF',
                column: 4,
                itemText: {
                    color: '#000',
                    size: 12,
                    marginT: 8
                },
                itemIcon: {
                    size: 30
                },
                cancel: {
                    bg: 'fs://icon.png',
                    color: '#000',
                    h: 44,
                    size: 14
                }
            },
            tapClose: true
        }, function(ret) {
            if (ret.eventType == 'cancel') {
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
            }
            if (ret.index == "0") {
                var imgaesFx = host + '/' + sma;
                // console.log(imgaesFx);
                api.download({
                    url: imgaesFx,
                    savePath: 'fs:savePath/' + sma,
                    report: true,
                    cache: true,
                    allowResume: true
                }, function(ret, err) {
                    // console.log(JSON.stringify(ret));
                    if (ret.state == 1) {
                        //下载成功
                        var savePath = ret.savePath;
                        // console.log(savePath);
                        var songListID = id;
                        var title = titleName;
                        shareMp3Single(songListID, title, savePath);
                        // var savePath = '';
                        // shareMp3Single(songListID,title,savePath);
                        // shareMp3Album(name,listening_description,l_id);
                    } else {
                        // console.log(JSON.stringify(err));
                    }
                });
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
                // alert(1);
            } else if (ret.index == "1") {
                var imgaesFx = host + '/' + sma;
                // console.log(imgaesFx);
                api.download({
                    url: imgaesFx,
                    savePath: 'fs:savePath/' + sma,
                    report: true,
                    cache: true,
                    allowResume: true
                }, function(ret, err) {
                    // console.log(JSON.stringify(ret));
                    if (ret.state == 1) {
                        //下载成功
                        var savePath = ret.savePath;
                        // console.log(savePath);
                        var songListID = id;
                        var title = titleName;
                        initTimelineSingle(songListID, title, savePath);
                        // var savePath = '';
                        // shareMp3Single(songListID,title,savePath);
                        // shareMp3Album(name,listening_description,l_id);
                    } else {
                        // console.log(JSON.stringify(err));
                    }
                });
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
                // alert(3);
            } else if (ret.index == "2") {

                var imgaesFx = host + '/' + sma;
                api.download({
                    url: imgaesFx,
                    savePath: 'fs:savePath/' + sma,
                    report: true,
                    cache: true,
                    allowResume: true
                }, function(ret, err) {
                    // console.log(JSON.stringify(ret));
                    if (ret.state == 1) {
                        //下载成功
                        var savePath = ret.savePath;
                        // console.log(savePath);
                        var songListID = id;
                        var title = titleName;
                        // var savePath = 'undefined'
                        fnQQZoneSingle(songListID, title, savePath);
                        // var savePath = '';
                        // shareMp3Single(songListID,title,savePath);
                        // shareMp3Album(name,listening_description,l_id);
                    } else {
                        // console.log(JSON.stringify(err));
                    }
                });
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
                // alert(2);
            } else if (ret.index == "3") {
                var imgaesFx = host + '/' + sma;
                api.download({
                    url: imgaesFx,
                    savePath: 'fs:savePath/' + sma,
                    report: true,
                    cache: true,
                    allowResume: true
                }, function(ret, err) {
                    // console.log(JSON.stringify(ret));
                    if (ret.state == 1) {
                        //下载成功
                        var savePath = ret.savePath;
                        // console.log(savePath);
                        var songListID = id;
                        var title = titleName;
                        fnintnQQSingle(songListID, title, savePath);
                        // var savePath = '';
                        // shareMp3Single(songListID,title,savePath);
                        // shareMp3Album(name,listening_description,l_id);
                    } else {
                        // console.log(JSON.stringify(err));
                    }
                });
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
                // alert(2);


            } else {
                dialogBox.close({
                    dialogName: 'actionMenu'
                });
            }
            // dialogBox.close({
            //     dialogName: 'alert'
            // })
            // alert(JSON.stringify(ret))

        });
        // alert(id);
    }
    //添加到听单
    function fnOpenAddListening(id) {
        api.openWin({
            name: 'addListening',
            url: './add_listening.html',
            pageParam: {
                songListID: id,
                ok: 'add_listening'

            }
        });
    }

    function openFM(id) {
        api.openWin({
            name: 'playDanQu',
            url: './playDanQu.html',
            pageParam: {
                a: id,
                ok: 'playDanQu',
                playType: 'playDanQu'
            }
        });
    }

    function fnalert(id) {
        // console.log(id);
        var dialogBox = api.require('dialogBox');
        dialogBox.alert({
            texts: {
                title: '确认删除',
                // content: '送你一个超级礼包，内有超值福利，先到先得，点击领取 >>',
                leftBtnTitle: '取消',
                rightBtnTitle: '确认'
            },
            styles: {
                bg: '#fff',
                w: 300,
                title: {
                    marginT: 20,
                    icon: 'widget://res/gou.png',
                    iconSize: 40,
                    titleSize: 14,
                    titleColor: '#000'
                },
                content: {
                    color: '#000',
                    size: 14
                },
                left: {
                    marginB: 7,
                    marginL: 20,
                    w: 130,
                    h: 35,
                    corner: 2,
                    bg: '#ccc',
                    size: 12,
                    color: '#fff'
                },
                right: {
                    marginB: 7,
                    marginL: 10,
                    w: 130,
                    h: 35,
                    corner: 2,
                    bg: '#ccc',
                    size: 12,
                    color: '#fff'
                }
            },
            tapClose: true
        }, function(ret) {
            if (ret.eventType == 'left') {
                // alert("确认删除");
                var dialogBox = api.require('dialogBox');
                dialogBox.close({
                    dialogName: 'alert'
                });
            } else {
                // alert("确认删除");
                api.ajax({
                    url: host + apiUri + '/user/del_records/' + id,
                    method: 'post',
                    dataType: 'json',
                    headers: {
                        "source": api.systemType,
                        "version": version,
                        "session": token
                    },
                    // data: {
                    //     values: {
                    //         name: 'haha'
                    //     }
                    // }
                }, function(ret, err) {
                    if (ret) {
                        console.log(JSON.stringify(ret));
                        if (ret.status == 200) {
                            console.log(1111);
                            var p = 1;
                            fnProductList();
                        }
                    } else {
                        // alert( JSON.stringify( err ) );
                    }
                });

                var dialogBox = api.require('dialogBox');
                dialogBox.close({
                    dialogName: 'alert'
                });
            }
        });
    }
</script>
